@page "/Courses"
@model A.C.E.S.Pages.Courses.CoursesModel
@{
    ViewData["Title"] = "Courses";
}


<section id="top-bar">
    <div>
        <input id="filter-course-name" type="text" placeholder="Search Course" onkeyup="LoadList()" />
        <input id="filter-assignment-name" type="text" placeholder="Search Assignment" onkeyup="LoadList()" />
    </div>
    <div>
        <a class="button" href="./Courses/Add">+ Add Course</a>
    </div>
</section>
<section id="course-list">

</section>
<script>
    function LoadList() {
        var cname = document.getElementById('filter-course-name').value;
        var aname = document.getElementById('filter-assignment-name').value;

        var elem = document.getElementById('course-list');
        elem.innerHTML = "";

        var courses = JSON.parse('@Json.Serialize(Model.Courses)');
        for (var course of courses) {
            if (course.archived) continue;
            if (!course.name.toLowerCase().includes(cname.toLowerCase())) continue;

            var accordion = document.createElement('div');
            accordion.classList.add('accordion');
            accordion.innerHTML += `<div class="accordion-header">${course.name}</div>`;

            var content = document.createElement('div');
            content.classList.add('accordion-content');

            for (var assignment of course.assignments) {
                content.innerHTML += `<div><a href="/Courses/${course.id}/Assignments/${assignment.id}">${assignment.name}</a></div>`;
            }
            content.innerHTML += `<div><a href="/Courses/${course.id}/Assignments/Add">Add Assignment</a></div>`;

            accordion.appendChild(content);
            elem.appendChild(accordion);
        }
        $('.accordion-content').hide();
    }

    LoadList();
</script>